var qiao={};$.fn.qser=function(){var c,a={},b=$(this).serializeArray();if(0!=b.length)for(c=0;c<b.length;c++)a[b[c].name]=b[c].value;return a},$.fn.qdata=function(){var c,d,e,a={},b=$(this).attr("data");if(b)for(c=b.split(";"),d=0;d<c.length;d++)c[d]&&(e=c[d].split(":"),a[e[0]]=e[1]);return a},qiao.on=function(a,b,c){$(document).off(b,a).on(b,a,c)},qiao.is=function(a,b){if(a&&b){if("number"==b)return/^\d+$/g.test(a);if("mobile"==b)return/^1\d{10}$/g.test(a)}},qiao.ajaxoptions={url:"",data:{},type:"post",dataType:"json",async:!0,crossDomain:!1},qiao.ajaxopt=function(a){var b=$.extend({},qiao.ajaxoptions);return"string"==typeof a?b.url=a:$.extend(b,a),b},qiao.ajax=function(a,b,c){if(a){var d=qiao.ajaxopt(a);"undefined"!=typeof base&&(d.url=base+d.url),$.ajax(d).done(function(a){b&&b(a)}).fail(function(a){c?c(a):alert("数据传输失败，请重试！")})}},qiao.totop=function(a){var c,b=$(a);b.hide().click(function(){$("body, html").animate({scrollTop:"0px"})}),c=$(window),c.scroll(function(){c.scrollTop()>0?b.fadeIn():b.fadeOut()})},$.fn.qcode=function(a){if(a){var b={};"string"==typeof a?b.text=a:(a.text&&(b.text=a.text),a.type&&"ch"==a.type&&(b.text=qiao.qrcodetochar(b.text)),a.render&&"table"==a.render&&(b.render=a.render),a.width&&(b.width=a.width),a.height&&(b.height=a.height)),$(this).qrcode(b)}},qiao.qrcodetochar=function(a){var b,c,d,e;for(b="",d=a.length,c=0;d>c;c++)e=a.charCodeAt(c),e>=1&&127>=e?b+=a.charAt(c):e>2047?(b+=String.fromCharCode(224|15&e>>12),b+=String.fromCharCode(128|63&e>>6),b+=String.fromCharCode(128|63&e>>0)):(b+=String.fromCharCode(192|31&e>>6),b+=String.fromCharCode(128|63&e>>0));return b},qiao.end=function(a,b,c){a?(b=b||$(window),c=c||$(document),b.scroll(function(){b.scrollTop()+b.height()>=c.height()&&a()})):$(window).scroll(null)},qiao.cookie=function(a,b){return"undefined"==typeof b?$.cookie(a):(null==b?$.cookie(a,b,{path:"/",expires:-1}):$.cookie(a,b,{path:"/",expires:1}),void 0)},qiao.search=function(a){var b,d,e,f,c=location.search;if(c&&(c=c.substr(1)))for(d=c.split("&"),e=0;e<d.length;e++)f=d[e].split("="),f&&f[0]==a&&(b=f[1]);return b},qiao.bs={},qiao.bs.modaloptions={id:"bsmodal",url:"",fade:"fade",close:!0,title:"title",head:!0,foot:!0,btn:!1,okbtn:"确定",qubtn:"取消",msg:"msg",big:!1,show:!1,remote:!1,backdrop:"static",keyboard:!0,style:"",mstyle:"",callback:null},qiao.bs.modalstr=function(a){var c,d,e,f,b='<div class="modal '+a.fade+'" id="'+a.id+'" tabindex="-1" role="dialog" aria-labelledby="bsmodaltitle" aria-hidden="true" style="position:fixed;top:20px;'+a.style+'">';return b+=a.big?'<div class="modal-dialog modal-lg" style="'+a.mstyle+'"><div class="modal-content">':'<div class="modal-dialog" style="'+a.mstyle+'"><div class="modal-content">',c="</div></div></div>",d="",a.head&&(d+='<div class="modal-header">',a.close&&(d+='<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>'),d+='<h3 class="modal-title" id="bsmodaltitle">'+a.title+"</h3></div>"),e='<div class="modal-body"><p><h4>'+a.msg+"</h4></p></div>",f="",a.foot&&(f+='<div class="modal-footer"><button type="button" class="btn btn-primary bsok">'+a.okbtn+"</button>",a.btn&&(f+='<button type="button" class="btn btn-default bscancel">'+a.qubtn+"</button>"),f+="</div>"),b+d+e+f+c},qiao.bs.alert=function(a,b){var d,c=$.extend({},qiao.bs.modaloptions);c.title="提示","string"==typeof a?c.msg=a:$.extend(c,a),$("body").append(qiao.bs.modalstr(c)),d=$("#"+c.id),d.modal(c),qiao.on("button.bsok","click",function(){b&&b(),d.modal("hide")}),qiao.on("#"+c.id,"hidden.bs.modal",function(){d.remove()}),d.modal("show")},qiao.bs.confirm=function(a,b,c){var e,d=$.extend({},qiao.bs.modaloptions);d.title="确认操作","string"==typeof a?d.msg=a:$.extend(d,a),d.btn=!0,$("body").append(qiao.bs.modalstr(d)),e=$("#"+d.id),e.modal(d),qiao.on("button.bsok","click",function(){b&&b(),e.modal("hide")}),qiao.on("button.bscancel","click",function(){c&&c(),e.modal("hide")}),qiao.on("#"+d.id,"hidden.bs.modal",function(){e.remove()}),e.modal("show")},qiao.bs.dialog=function(a,b){var d,c=$.extend({},qiao.bs.modaloptions,a);c.big=!0,$("body").append(qiao.bs.modalstr(c)),qiao.ajax({url:a.url,dataType:"html"},function(b){$("#"+c.id+" div.modal-body").empty().append(b),a.callback&&a.callback()}),d=$("#"+c.id),d.modal(c),qiao.on("button.bsok","click",function(){var a=!0;b&&(a=b()),a&&d.modal("hide")}),qiao.on("button.bscancel","click",function(){d.modal("hide")}),qiao.on("#"+c.id,"hidden.bs.modal",function(){d.remove()}),d.modal("show")},qiao.bs.msgoptions={msg:"msg",type:"info",time:2e3,position:"top"},qiao.bs.msgstr=function(a,b,c){return'<div class="alert alert-'+b+' alert-dismissible" role="alert" style="display:none;position:fixed;'+c+':0;left:0;width:100%;z-index:2001;margin:0;text-align:center;" id="bsalert"><button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>'+a+"</div>"},qiao.bs.msg=function(a){var b=$.extend({},qiao.bs.msgoptions);"string"==typeof a?b.msg=a:$.extend(b,a),$("body").prepend(qiao.bs.msgstr(b.msg,b.type,b.position)),$("#bsalert").slideDown(),setTimeout(function(){$("#bsalert").slideUp(function(){$("#bsalert").remove()})},b.time)},qiao.bs.popoptions={animation:!0,container:"body",content:"content",html:!0,placement:"bottom",title:"",trigger:"hover"},$.fn.bstip=function(a){var b=$.extend({},qiao.bs.popoptions);"string"==typeof a?b.title=a:$.extend(b,a),$(this).data(b).tooltip()},$.fn.bspop=function(a){var b=$.extend({},qiao.bs.popoptions);"string"==typeof a?b.content=a:$.extend(b,a),$(this).popover(b)},qiao.bs.tree={},qiao.bs.tree.options={url:"",height:"600px",open:!0,edit:!1,checkbox:!1,showurl:!0},$.fn.bstree=function(a){var c,d,b=$.extend({},qiao.bs.tree.options);a&&("string"==typeof a?b.url=a:$.extend(b,a)),c="加载失败！",d=$(this),qiao.ajax(b.url+"/tree",function(a){var e,f,g,h;a&&a.object&&(e=a.object,f='<div class="panel panel-info"><div class="panel-body" ',"auto"!=b.height&&(f+='style="height:600px;overflow-y:auto;"'),f+='><ul class="nav nav-list sidenav" id="treeul" data="url:'+b.url+';">',g=qiao.bs.tree.sub(e,b),h="</ul></div></div>",c=f+g+h),d.empty().append(c),qiao.bs.tree.init()})},qiao.bs.tree.sub=function(a,b){var d,e,c="";if(a){if(c='<li><a href="javascript:void(0);" data="id:'+a.id+";url:"+a.url+';">'+'<span class="glyphicon glyphicon-minus"></span>',b.checkbox&&(c+='<input type="checkbox" class="treecheckbox" ',a.checked&&(c+="checked"),c+="/>"),c+=a.text,b.showurl&&(c+="("+a.url+")"),b.edit&&(c+='&nbsp;&nbsp;<span class="label label-primary bstreeadd">添加子菜单</span>&nbsp;&nbsp;<span class="label label-primary bstreeedit">修改</span>&nbsp;&nbsp;<span class="label label-danger  bstreedel">删除</span>'),c+="</a>",d=a.children,d&&d.length>0){for(c+='<ul style="padding-left:20px;" id="treeid_'+a.id+'" class="nav collapse ',b.open&&(c+="in"),c+='">',e=0;e<d.length;e++)c+=qiao.bs.tree.sub(d[e],b);c+="</ul>"}c+="</li>"}return c},qiao.bs.tree.init=function(){qiao.on("#treeul .glyphicon-minus","click",function(){$(this).parent().next().length>0&&($("#treeid_"+$(this).parents("a").qdata().id).collapse("hide"),$(this).removeClass("glyphicon-minus").addClass("glyphicon-plus"))}),qiao.on("#treeul .glyphicon-plus","click",function(){$(this).parent().next().length>0&&($("#treeid_"+$(this).parents("a").qdata().id).collapse("show"),$(this).removeClass("glyphicon-plus").addClass("glyphicon-minus"))}),qiao.on("input.treecheckbox","change",function(){var b,c,a=$(this).prop("checked");$(this).parent().next().find("input.treecheckbox").each(function(){$(this).prop("checked",a)}),b=!0,c=$(this).parent().parent().parent(),c.children().each(function(){var a=$(this).children().children("input").prop("checked");a||(b=!1)}),c.prev().children("input").prop("checked",b)}),qiao.bs.tree.url=$("#treeul").qdata().url,qiao.bs.tree.url&&(qiao.on(".bstreeadd","click",qiao.bs.tree.addp),qiao.on(".bstreedel","click",qiao.bs.tree.del),qiao.on(".bstreeedit","click",qiao.bs.tree.editp))},qiao.bs.tree.addp=function(){qiao.bs.dialog({url:qiao.bs.tree.url+"/add/"+$(this).parent().qdata().id,title:"添加子菜单",okbtn:"保存"},qiao.bs.tree.add)},qiao.bs.tree.add=function(){var a;return qiao.ajax({url:qiao.bs.tree.url+"/save",data:$("#bsmodal").find("form").qser(),async:!1},function(b){a=b}),qiao.bs.msg(a),a&&"success"==a.type?(qiao.crud.url=qiao.bs.tree.url,qiao.crud.reset(),!0):!1},qiao.bs.tree.del=function(){qiao.ajax({url:qiao.bs.tree.url+"/del/"+$(this).parent().qdata().id},function(a){qiao.bs.msg(a),a&&"success"==a.type&&(qiao.crud.url=qiao.bs.tree.url,qiao.crud.reset())})},qiao.bs.tree.editp=function(){qiao.bs.dialog({url:qiao.bs.tree.url+"/savep?id="+$(this).parent().qdata().id,title:"修改菜单",okbtn:"保存"},qiao.bs.tree.edit)},qiao.bs.tree.edit=function(){return qiao.crud.url=qiao.bs.tree.url,qiao.crud.save()},qiao.bs.spy=function(a,b){var c="body",d=".scrolldiv";b&&(c=b),a&&(d=a),$(c).scrollspy({target:d})},qiao.bs.initimg=function(){$("img").each(function(){var a=$(this).attr("class");a?-1==a.indexOf("img-responsive")&&$(this).addClass("img-responsive"):$(this).addClass("img-responsive")})},qiao.bs.bsdateoptions={autoclose:!0,language:"zh-CN",format:"yyyy-mm-dd"},qiao.bs.bsdate=function(a,b){var c,d;a&&(c=$(a),c.length>0&&(d=$.extend({},qiao.bs.bsdateoptions,b),c.each(function(){$(this).datepicker(d)})))},qiao.bs.bstrooptions={width:"500px",html:"true",nbtext:"下一步",place:"bottom",title:"网站使用引导",content:"content"},qiao.bs.bstroinit=function(a,b,c){var d,e;a&&(d=$(a),d.length>0&&(e=$.extend({},qiao.bs.bstrooptions,b),"string"==typeof b?e.content=b:$.extend(e,b),d.each(function(){$(this).attr({"data-bootstro-width":e.width,"data-bootstro-title":e.title,"data-bootstro-html":e.html,"data-bootstro-content":e.content,"data-bootstro-placement":e.place,"data-bootstro-nextButtonText":e.nbtext,"data-bootstro-step":c}).addClass("bootstro")})))},qiao.bs.bstroopts={prevButtonText:"上一步",finishButton:'<button class="btn btn-lg btn-success bootstro-finish-btn"><i class="icon-ok"></i>完成</button>',stopOnBackdropClick:!1,stopOnEsc:!1},qiao.bs.bstro=function(a,b){var c,d;if(a&&a.length>0){for(c=0;c<a.length;c++)qiao.bs.bstroinit(a[c][0],a[c][1],c);d=$.extend({},qiao.bs.bstroopts),b&&(b.hasOwnProperty("pbtn")&&(d.prevButtonText=b.pbtn),b.hasOwnProperty("obtn")&&(d.finishButton=""==b.obtn?"":'<button class="btn btn-mini btn-success bootstro-finish-btn"><i class="icon-ok"></i>'+b.obtn+"</button>"),b.hasOwnProperty("stop")&&(d.stopOnBackdropClick=b.stop,d.stopOnEsc=b.stop),b.hasOwnProperty("exit")&&(d.onExit=b.exit)),bootstro.start(".bootstro",d)}},qiao.bs.search=function(a,b){var c,d,e,f,g,h;a&&b&&b.url&&b.make&&b.back&&(c=$(a),d=b.zIndex||900,e=b.bgColor||"#fff",f=$('<table class="table table-bordered table-hover" style="position:absolute;display:none;margin-top:10px;width:95%;z-index:'+d+";background-color:"+e+';"></table>'),c.after(f),qiao.on(a,"keyup",function(){g&&clearTimeout(g),h&&h.abort(),g=setTimeout(function(){var a=c.val();a&&(h=$.ajax({url:base+b.url+"?code="+a,type:"get",dataType:"json"}).done(function(a){if(a&&"success"==a.type){var c=a.object;c&&c.length>0&&(f.empty(),$.each(c,function(a,c){c&&f.append('<tr class="qsearchtr" style="cursor:pointer;" data-id="'+c.id+'"><td>'+b.make(c)+"</td></tr>")}))}f.show()}))},500)}),qiao.on("tr.qsearchtr","click",function(){b.back($(this).data("id")),c.val($(this).find("td").text()),f.hide()}))},qiao.crud={},qiao.crud.url="",qiao.crud.init=function(){qiao.on(".menus","click",function(){var a=$(this).qdata().url;a&&(qiao.crud.url=a,qiao.crud.reset())}),qiao.crud.bindcrud(),qiao.crud.bindpage()},qiao.crud.bindcrud=function(){qiao.on(".allcheck","change",function(){$(".onecheck").prop("checked",$(this).prop("checked"))}),qiao.on(".addBtn","click",function(){qiao.crud.savep("添加")}),qiao.on(".editbtn","click",function(){qiao.crud.savep("修改",$(this).parents("tr").qdata().id)}),qiao.on(".queBtn","click",function(){qiao.crud.search("查询")}),qiao.on(".relBtn","click",function(){qiao.crud.reset()}),qiao.on(".delBtn","click",function(){qiao.crud.del()}),qiao.on(".delbtn","click",function(){qiao.crud.del($(this).parents("tr").qdata().id)})},qiao.crud.listopt={pageNumber:1,pageSize:10},qiao.crud.list=function(a){var b={url:qiao.crud.url+"/index"};a&&$.extend(qiao.crud.listopt,a),b.data=qiao.crud.listopt,b.dataType="html",qiao.ajax(b,function(a){$("#cruddiv").empty().append(a)})},qiao.crud.reset=function(){qiao.crud.listopt={pageNumber:1,pageSize:10},qiao.crud.list()},qiao.crud.search=function(a){qiao.bs.dialog({title:a,url:qiao.crud.url+"/search"},function(){return qiao.crud.list($("#bsmodal").find("form").qser()),!0})},qiao.crud.savep=function(a,b){var c=b?qiao.crud.url+"/savep?id="+b:qiao.crud.url+"/savep";qiao.bs.dialog({title:a,url:c},function(){return qiao.crud.save()})},qiao.crud.save=function(){var a;return qiao.ajax({async:!1,url:qiao.crud.url+"/save",data:$("#bsmodal").find("form").qser()},function(b){a=b}),qiao.bs.msg(a),a&&"success"==a.type?(qiao.crud.list(),!0):!1},qiao.crud.del=function(a){var b=[];a?b.push(a):$(".onecheck:checked").each(function(){b.push($(this).parents("tr").qdata().id)}),b.length?qiao.bs.confirm("确认要删除所选记录吗（若有子记录也会同时删除）？",function(){qiao.ajax({url:qiao.crud.url+"/del",data:{ids:b.join(",")}},function(a){qiao.bs.msg(a),qiao.crud.list()})}):qiao.bs.alert("请选择要删除的记录！")},qiao.crud.bindpage=function(){qiao.on(".crudfirst","click",function(){$(this).parent().hasClass("disabled")||qiao.crud.reset()}),qiao.on(".crudprev","click",function(){$(this).parent().hasClass("disabled")||qiao.crud.list({pageNumber:qiao.crud.listopt.pageNumber-1})}),qiao.on(".crudnext","click",function(){$(this).parent().hasClass("disabled")||qiao.crud.list({pageNumber:qiao.crud.listopt.pageNumber+1})}),qiao.on(".crudlast","click",function(){$(this).parent().hasClass("disabled")||qiao.crud.list({pageNumber:$(this).qdata().page})}),qiao.on(".cruda","click",function(){$(this).parent().hasClass("disabled")||qiao.crud.list({pageNumber:parseInt($(this).text())})}),qiao.on(".pagesize","change",function(){var a=$(this).val();a&&(qiao.crud.listopt.pageSize=a),qiao.crud.list({pageSize:a})})};